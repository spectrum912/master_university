import numpy as np
from scipy.fftpack import dct, idct


def adct2(block):
    return dct(dct(block.T, norm='ortho').T, norm='ortho')


def idct2(dct_block):
    return idct(idct(dct_block.T, norm='ortho').T, norm='ortho')


def getDCT_Matrix(bsize = 8):
    if bsize == 2:
        DCT_Creator = np.array([
            [0.707106781186548, 0.707106781186548],
            [0.707106781186548, -0.707106781186548]
        ])

        DCT_Creator_T = DCT_Creator
    if bsize == 4:
        DCT_Creator = np.array([
            [0.500000000000000, 0.500000000000000, 0.500000000000000, 0.500000000000000],
            [0.653281482438188, 0.270598050073099, -0.270598050073099, -0.653281482438188],
            [0.500000000000000, -0.500000000000000, -0.500000000000000, 0.500000000000000],
            [0.270598050073099, -0.653281482438188, 0.653281482438188, -0.270598050073099]
        ])

        DCT_Creator_T = np.array([
            [0.500000000000000, 0.653281482438188, 0.500000000000000, 0.270598050073099],
            [0.500000000000000, 0.270598050073099, -0.500000000000000, -0.653281482438188],
            [0.500000000000000, -0.270598050073099, -0.500000000000000, 0.653281482438188],
            [0.500000000000000, -0.653281482438188, 0.500000000000000, -0.270598050073099]
        ])
    if bsize == 8:
        DCT_Creator = np.array([
            [0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536],
            [0.4904, 0.4157, 0.2778, 0.0975, -0.0975, -0.2778, -0.4157, -0.4904],
            [0.4619, 0.1913, -0.1913, -0.4619, -0.4619, -0.1913, 0.1913, 0.4619],
            [0.4157, -0.0975, -0.4904, -0.2778, 0.2778, 0.4904, 0.0975, -0.4157],
            [0.3536, -0.3536, -0.3536, 0.3536, 0.3536, -0.3536, -0.3536, 0.3536],
            [0.2778, -0.4904, 0.0975, 0.4157, -0.4157, -0.0975, 0.4904, -0.2778],
            [0.1913, -0.4619, 0.4619, -0.1913, -0.1913, 0.4619, -0.4619, 0.1913],
            [0.0975, -0.2778, 0.4157, -0.4904, 0.4904, -0.4157, 0.2778, -0.0975]
        ])

        DCT_Creator_T = np.array([
            [0.3536, 0.4904, 0.4619, 0.4157, 0.3536, 0.2778, 0.1913, 0.0975],
            [0.3536, 0.4157, 0.1913, -0.0975, -0.3536, -0.4904, -0.4619, -0.2778],
            [0.3536, 0.2778, -0.1913, -0.4904, -0.3536, 0.0975, 0.4619, 0.4157],
            [0.3536, 0.0975, -0.4619, -0.2778, 0.3536, 0.4157, -0.1913, -0.4904],
            [0.3536, -0.0975, -0.4619, 0.2778, 0.3536, -0.4157, -0.1913, 0.4904],
            [0.3536, -0.2778, -0.1913, 0.4904, -0.3536, -0.0975, 0.4619, -0.4157],
            [0.3536, -0.4157, 0.1913, 0.0975, -0.3536, 0.4904, -0.4619, 0.2778],
            [0.3536, -0.4904, 0.4619, -0.4157, 0.3536, -0.2778, 0.1913, -0.0975]
        ])
    if bsize == 16:
        DCT_Creator = np.array([
            [0.250000000000000, 0.250000000000000, 0.250000000000000, 0.250000000000000, 0.250000000000000,
             0.250000000000000, 0.250000000000000, 0.250000000000000, 0.250000000000000, 0.250000000000000,
             0.250000000000000, 0.250000000000000, 0.250000000000000, 0.250000000000000, 0.250000000000000,
             0.250000000000000],
            [0.351850934381596, 0.338329500293588, 0.311806253246668, 0.273300466750439, 0.224291896585659,
             0.166663914619437, 0.102631131880589, 0.0346542922997729, -0.0346542922997729, -0.102631131880589,
             -0.166663914619437, -0.224291896585659, -0.273300466750439, -0.311806253246668, -0.338329500293588,
             -0.351850934381596],
            [0.346759961330537, 0.293968900604840, 0.196423739596776, 0.0689748448207358, -0.0689748448207357,
             -0.196423739596775, -0.293968900604840, -0.346759961330537, -0.346759961330537, -0.293968900604840,
             -0.196423739596776, -0.0689748448207359, 0.0689748448207358, 0.196423739596775, 0.293968900604840,
             0.346759961330537],
            [0.338329500293588, 0.224291896585659, 0.0346542922997729, -0.166663914619437, -0.311806253246668,
             -0.351850934381596, -0.273300466750439, -0.102631131880590, 0.102631131880590, 0.273300466750439,
             0.351850934381596, 0.311806253246668, 0.166663914619437, -0.0346542922997726, -0.224291896585659,
             -0.338329500293588],
            [0.326640741219094, 0.135299025036549, -0.135299025036549, -0.326640741219094, -0.326640741219094,
             -0.135299025036549, 0.135299025036549, 0.326640741219094, 0.326640741219094, 0.135299025036550,
             -0.135299025036549, -0.326640741219094, -0.326640741219094, -0.135299025036550, 0.135299025036549,
             0.326640741219094],
            [0.311806253246668, 0.0346542922997729, -0.273300466750439, -0.338329500293588, -0.102631131880589,
             0.224291896585659, 0.351850934381596, 0.166663914619437, -0.166663914619437, -0.351850934381596,
             -0.224291896585659, 0.102631131880589, 0.338329500293588, 0.273300466750440, -0.0346542922997732,
             -0.311806253246668],
            [0.293968900604840, -0.0689748448207357, -0.346759961330537, -0.196423739596776, 0.196423739596775,
             0.346759961330537, 0.0689748448207356, -0.293968900604839, -0.293968900604840, 0.0689748448207354,
             0.346759961330537, 0.196423739596776, -0.196423739596775, -0.346759961330537, -0.0689748448207364,
             0.293968900604839],
            [0.273300466750439, -0.166663914619437, -0.338329500293588, 0.0346542922997727, 0.351850934381596,
             0.102631131880590, -0.311806253246668, -0.224291896585660, 0.224291896585659, 0.311806253246668,
             -0.102631131880589, -0.351850934381596, -0.0346542922997724, 0.338329500293588, 0.166663914619437,
             -0.273300466750439],
            [0.250000000000000, -0.250000000000000, -0.250000000000000, 0.250000000000000, 0.250000000000000,
             -0.250000000000000, -0.250000000000000, 0.250000000000000, 0.250000000000000, -0.250000000000000,
             -0.250000000000000, 0.250000000000000, 0.250000000000000, -0.250000000000000, -0.250000000000000,
             0.250000000000000],
            [0.224291896585659, -0.311806253246668, -0.102631131880589, 0.351850934381596, -0.0346542922997726,
             -0.338329500293588, 0.166663914619437, 0.273300466750440, -0.273300466750439, -0.166663914619437,
             0.338329500293588, 0.0346542922997737, -0.351850934381596, 0.102631131880589, 0.311806253246668,
             -0.224291896585659],
            [0.196423739596776, -0.346759961330537, 0.0689748448207358, 0.293968900604840, -0.293968900604840,
             -0.0689748448207363, 0.346759961330537, -0.196423739596775, -0.196423739596776, 0.346759961330537,
             -0.0689748448207359, -0.293968900604840, 0.293968900604840, 0.0689748448207365, -0.346759961330537,
             0.196423739596775],
            [0.166663914619437, -0.351850934381596, 0.224291896585659, 0.102631131880589, -0.338329500293588,
             0.273300466750439, 0.0346542922997723, -0.311806253246668, 0.311806253246668, -0.0346542922997718,
             -0.273300466750439, 0.338329500293588, -0.102631131880589, -0.224291896585660, 0.351850934381596,
             -0.166663914619435],
            [0.135299025036549, -0.326640741219094, 0.326640741219094, -0.135299025036549, -0.135299025036550,
             0.326640741219094, -0.326640741219094, 0.135299025036548, 0.135299025036549, -0.326640741219095,
             0.326640741219094, -0.135299025036549, -0.135299025036550, 0.326640741219095, -0.326640741219094,
             0.135299025036548],
            [0.102631131880589, -0.273300466750439, 0.351850934381596, -0.311806253246668, 0.166663914619437,
             0.0346542922997736, -0.224291896585659, 0.338329500293588, -0.338329500293588, 0.224291896585659,
             -0.0346542922997730, -0.166663914619437, 0.311806253246668, -0.351850934381596, 0.273300466750439,
             -0.102631131880588],
            [0.0689748448207358, -0.196423739596776, 0.293968900604840, -0.346759961330537, 0.346759961330537,
             -0.293968900604839, 0.196423739596776, -0.0689748448207346, -0.0689748448207352, 0.196423739596777,
             -0.293968900604840, 0.346759961330537, -0.346759961330537, 0.293968900604838, -0.196423739596775,
             0.0689748448207343],
            [0.0346542922997729, -0.102631131880589, 0.166663914619437, -0.224291896585659, 0.273300466750440,
             -0.311806253246668, 0.338329500293588, -0.351850934381596, 0.351850934381596, -0.338329500293588,
             0.311806253246668, -0.273300466750438, 0.224291896585659, -0.166663914619435, 0.102631131880589,
             -0.0346542922997715]
        ])

        DCT_Creator_T = np.array([
            [0.250000000000000, 0.351850934381596, 0.346759961330537, 0.338329500293588, 0.326640741219094,
             0.311806253246668, 0.293968900604840, 0.273300466750439, 0.250000000000000, 0.224291896585659,
             0.196423739596776, 0.166663914619437, 0.135299025036549, 0.102631131880589, 0.0689748448207358,
             0.0346542922997729],
            [0.250000000000000, 0.338329500293588, 0.293968900604840, 0.224291896585659, 0.135299025036549,
             0.0346542922997729, -0.0689748448207357, -0.166663914619437, -0.250000000000000, -0.311806253246668,
             -0.346759961330537, -0.351850934381596, -0.326640741219094, -0.273300466750439, -0.196423739596776,
             -0.102631131880589],
            [0.250000000000000, 0.311806253246668, 0.196423739596776, 0.0346542922997729, -0.135299025036549,
             -0.273300466750439, -0.346759961330537, -0.338329500293588, -0.250000000000000, -0.102631131880589,
             0.0689748448207358, 0.224291896585659, 0.326640741219094, 0.351850934381596, 0.293968900604840,
             0.166663914619437],
            [0.250000000000000, 0.273300466750439, 0.0689748448207358, -0.166663914619437, -0.326640741219094,
             -0.338329500293588, -0.196423739596776, 0.0346542922997727, 0.250000000000000, 0.351850934381596,
             0.293968900604840, 0.102631131880589, -0.135299025036549, -0.311806253246668, -0.346759961330537,
             -0.224291896585659],
            [0.250000000000000, 0.224291896585659, -0.0689748448207357, -0.311806253246668, -0.326640741219094,
             -0.102631131880589, 0.196423739596775, 0.351850934381596, 0.250000000000000, -0.0346542922997726,
             -0.293968900604840, -0.338329500293588, -0.135299025036550, 0.166663914619437, 0.346759961330537,
             0.273300466750440],
            [0.250000000000000, 0.166663914619437, -0.196423739596775, -0.351850934381596, -0.135299025036549,
             0.224291896585659, 0.346759961330537, 0.102631131880590, -0.250000000000000, -0.338329500293588,
             -0.0689748448207363, 0.273300466750439, 0.326640741219094, 0.0346542922997736, -0.293968900604839,
             -0.311806253246668],
            [0.250000000000000, 0.102631131880589, -0.293968900604840, -0.273300466750439, 0.135299025036549,
             0.351850934381596, 0.0689748448207356, -0.311806253246668, -0.250000000000000, 0.166663914619437,
             0.346759961330537, 0.0346542922997723, -0.326640741219094, -0.224291896585659, 0.196423739596776,
             0.338329500293588],
            [0.250000000000000, 0.0346542922997729, -0.346759961330537, -0.102631131880590, 0.326640741219094,
             0.166663914619437, -0.293968900604839, -0.224291896585660, 0.250000000000000, 0.273300466750440,
             -0.196423739596775, -0.311806253246668, 0.135299025036548, 0.338329500293588, -0.0689748448207346,
             -0.351850934381596],
            [0.250000000000000, -0.0346542922997729, -0.346759961330537, 0.102631131880590, 0.326640741219094,
             -0.166663914619437, -0.293968900604840, 0.224291896585659, 0.250000000000000, -0.273300466750439,
             -0.196423739596776, 0.311806253246668, 0.135299025036549, -0.338329500293588, -0.0689748448207352,
             0.351850934381596],
            [0.250000000000000, -0.102631131880589, -0.293968900604840, 0.273300466750439, 0.135299025036550,
             -0.351850934381596, 0.0689748448207354, 0.311806253246668, -0.250000000000000, -0.166663914619437,
             0.346759961330537, -0.0346542922997718, -0.326640741219095, 0.224291896585659, 0.196423739596777,
             -0.338329500293588],
            [0.250000000000000, -0.166663914619437, -0.196423739596776, 0.351850934381596, -0.135299025036549,
             -0.224291896585659, 0.346759961330537, -0.102631131880589, -0.250000000000000, 0.338329500293588,
             -0.0689748448207359, -0.273300466750439, 0.326640741219094, -0.0346542922997730, -0.293968900604840,
             0.311806253246668],
            [0.250000000000000, -0.224291896585659, -0.0689748448207359, 0.311806253246668, -0.326640741219094,
             0.102631131880589, 0.196423739596776, -0.351850934381596, 0.250000000000000, 0.0346542922997737,
             -0.293968900604840, 0.338329500293588, -0.135299025036549, -0.166663914619437, 0.346759961330537,
             -0.273300466750438],
            [0.250000000000000, -0.273300466750439, 0.0689748448207358, 0.166663914619437, -0.326640741219094,
             0.338329500293588, -0.196423739596775, -0.0346542922997724, 0.250000000000000, -0.351850934381596,
             0.293968900604840, -0.102631131880589, -0.135299025036550, 0.311806253246668, -0.346759961330537,
             0.224291896585659],
            [0.250000000000000, -0.311806253246668, 0.196423739596775, -0.0346542922997726, -0.135299025036550,
             0.273300466750440, -0.346759961330537, 0.338329500293588, -0.250000000000000, 0.102631131880589,
             0.0689748448207365, -0.224291896585660, 0.326640741219095, -0.351850934381596, 0.293968900604838,
             -0.166663914619435],
            [0.250000000000000, -0.338329500293588, 0.293968900604840, -0.224291896585659, 0.135299025036549,
             -0.0346542922997732, -0.0689748448207364, 0.166663914619437, -0.250000000000000, 0.311806253246668,
             -0.346759961330537, 0.351850934381596, -0.326640741219094, 0.273300466750439, -0.196423739596775,
             0.102631131880589],
            [0.250000000000000, -0.351850934381596, 0.346759961330537, -0.338329500293588, 0.326640741219094,
             -0.311806253246668, 0.293968900604839, -0.273300466750439, 0.250000000000000, -0.224291896585659,
             0.196423739596775, -0.166663914619435, 0.135299025036548, -0.102631131880588, 0.0689748448207343,
             -0.0346542922997715]
        ])
    return (DCT_Creator, DCT_Creator_T)